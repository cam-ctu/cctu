<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Use cttab in the Analysis • cctu</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use cttab in the Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cctu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analysis-template.html">Analysis Template</a></li>
    <li><a class="dropdown-item" href="../articles/using-cttab.html">Use cttab in the Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/rmarkdown_report.html">Generate HTML Report</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cam-ctu/cctu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Use cttab in the Analysis</h1>
                        <h4 data-toc-skip class="author">Alimu
Dayimu</h4>
            
            <h4 data-toc-skip class="date">2025-11-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cam-ctu/cctu/blob/master/vignettes/using-cttab.Rmd" class="external-link"><code>vignettes/using-cttab.Rmd</code></a></small>
      <div class="d-none name"><code>using-cttab.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-this-document-does">What this Document Does<a class="anchor" aria-label="anchor" href="#what-this-document-does"></a>
</h2>
<p>The package <code>cctu</code> has been updated to utilize the DLU
file and CLU file to facilitate the analyzing process. The newly added
functions will not affect previous process. But here, in this document
we are going to learn some new functions provided in the package to
facilitate your analysis. Before you start, you should get yourself
familiarized with the <code>cctu</code> package by looking through the
<code>Analysis Template</code> vignette. <strong>Remember, the
<code>sumby</code> function will not benefit from any of the data
attribute related new functions mentioned in this document</strong>.
Namely, the variable label and value labels will not have an effect on
the output. You don’t need to go through everything in this document if
you are going to stick to the <code>sumby</code> function.</p>
</div>
<div class="section level2">
<h2 id="whats-new">What’s new<a class="anchor" aria-label="anchor" href="#whats-new"></a>
</h2>
<div class="section level3">
<h3 id="variable-and-value-label">Variable and value label<a class="anchor" aria-label="anchor" href="#variable-and-value-label"></a>
</h3>
<p>If you are familiar with <code>SAS</code>, <code>Stata</code> or
<code>SPSS</code>, you should already know there’s a variable label and
value label (variable format in some). The variable label gives you the
description of the variable, and the value label is to explain what the
values stand for. The variable will stay as a numeric but has categories
attached to it. Which means, you can subset or manipulate it like a
numerical variable but report the data as a categorical one. It is
important to understand this, let’s use <code>mtcars</code> dataset and
demonstrate how it works.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="co"># Assign variable label</span></span>
<span><span class="fu"><a href="../reference/var_lab.html">var_lab</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Transmission"</span></span>
<span></span>
<span><span class="co"># Assign value label with named vector</span></span>
<span><span class="fu"><a href="../reference/val_lab.html">val_lab</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Automatic"</span> <span class="op">=</span> <span class="fl">0</span>, <span class="st">"Manual"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:32] 1 1 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "label")= chr "Transmission"</span></span>
<span><span class="co">#&gt;  - attr(*, "labels")= Named num [1:2] 0 1</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:2] "Automatic" "Manual"</span></span></code></pre></div>
<p>As you can above, <code>label</code> and <code>labels</code>
attributes were added. But the variable is numeric. You can still
summarize it as numeric variable as below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;  0.0000  0.0000  0.0000  0.4062  1.0000  1.0000</span></span></code></pre></div>
<p>You can convert the value label to factor just before your final
analysis. The <code>to_factor</code> function replace the value with
labels and convert the variable to factor.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract variable label</span></span>
<span><span class="fu"><a href="../reference/var_lab.html">var_lab</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Transmission"</span></span>
<span></span>
<span><span class="co"># Convert variable to factor with labels attached to it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/to_factor.html">to_factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Automatic    Manual </span></span>
<span><span class="co">#&gt;        19        13</span></span></code></pre></div>
<p>But be cautious, <strong>some R process might drop the variable or
value label attributes</strong>. Normally it won’t, but you should check
it before report if you are not sure. For example,
<code>as.numeric</code>, <code>as.character</code> and
<code>as.logiac</code> will drop the variable and value label. There are
<code>to_numeric</code>, <code>to_character</code> and
<code>to_logical</code> can be used to convert the data type. You can
also use the <code>copy_lab</code> function to copy the variable and
value labels from the other variable.</p>
<p>You can use <code>var_lab</code> to extract the variable label or
assign one. And use <code>has_label</code> to check if the variable has
any variable label with it. You may also want to use
<code>drop_lab</code> to drop the variable label.</p>
<p>For value label, you can use <code>val_lab</code> to extract or
assign value label. And use <code>has_labels</code> to check if the
variable has a value label. There are also <code>unval</code> function
to drop the value label and <code>lab2val</code> to replace the
<code>data.frame</code> value to its corresponding value labels.</p>
</div>
<div class="section level3">
<h3 id="macro-dataset-utility-functions">MACRO dataset utility functions<a class="anchor" aria-label="anchor" href="#macro-dataset-utility-functions"></a>
</h3>
<p>There are new functions have been added to utilize the DLU and CLU
files for the data analysis. The <code>apply_macro_dict</code> function
uses DLU and CLU file to assign variable and value labels to the
dataset. This function will convert the variable name in the data and
DLU to lower case by default. This will also convert the dataset based
on the variable type as in the DLU file. If you don’t want to convert
the variable name to lower cases, you should set
<code>clean_names = FALSE</code>.</p>
<p>The <code>extract_form</code> can extract MACRO data by form and
visits. The data will be converted to <code>data.table</code> class,
which is an extension of the <code>data.frame</code> and works exactly
the same. It is a great package with lots of data manipulation
capability, you should seek the <a href="https://CRAN.R-project.org/package=data.table" class="external-link">website</a> for
more details. But one thing to remember is that all the names in the
variable selection will be considered as a variable of the data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"am"</span><span class="op">)</span></span>
<span><span class="co"># You can do this in the normal data.frame</span></span>
<span><span class="va">mtcars</span><span class="op">[</span>, <span class="va">vars</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># But you can't do this for the data.table</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">[</span>, <span class="va">vars</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># You need to add with=FALSE to do that</span></span>
<span><span class="va">mtcars</span><span class="op">[</span>, <span class="va">vars</span>, with <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="table-function">Table function<a class="anchor" aria-label="anchor" href="#table-function"></a>
</h3>
<p>You might already knew how to use the <code>sumby</code> function,
but now a new function called <code>cttab</code> has been added. The
difference between these two functions are the latter can handle
variable label and value labels. You can feed the labelled data to this
function and it will populate a summary table. Report data by treatment
group, stratify tables by visit. Also, you can report variable based on
some conditions and group the variable in the report. It generates a
missing report internally and you can dump the missing report at the
end. No extra step is needed. It will also produce the summary plots of
the variables. The produced plots will be arrange to 3 by 3 and new plot
will be producd if the variables exceeds 9. The remaining of this
document will show you with a working case.</p>
</div>
<div class="section level3">
<h3 id="setting-options">Setting options<a class="anchor" aria-label="anchor" href="#setting-options"></a>
</h3>
<p>The <code>cctab</code> function has a good flexibility, which means
it has lots of parameters you can use. You should check out the manual
of the <code>cctab</code> function. But, you can use
<code>options</code> to set the default value of the parameters to be
used by <code>cctab</code>. Below is setting some of the options, for
more details please check out the <code>cctab</code> function
manuals.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cctu_digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># keep 3 digits for numerical value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cctu_digits_pct <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># keep 0 digits for percentage</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cctu_subjid_string <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span> <span class="co"># Set subject ID string</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>cctu_print_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Don't produce plots</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-example">Working example<a class="anchor" aria-label="anchor" href="#working-example"></a>
</h2>
<p>In this section, we will show how to populate tables.</p>
<div class="section level3">
<h3 id="data-reading">Data reading<a class="anchor" aria-label="anchor" href="#data-reading"></a>
</h3>
<div class="section level4">
<h4 id="usual-case">Usual case<a class="anchor" aria-label="anchor" href="#usual-case"></a>
</h4>
<p>You should read the data as before, but you can and should read the
data by setting all the columns to character. This will be handled
later. Same process can be found in the <code>Analysis Template</code>
vignette.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read example data</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pilotdata.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span>, colClasses <span class="op">=</span> <span class="st">"character"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read DLU and CLU</span></span>
<span><span class="va">dlu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pilotdata_dlu.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pilotdata_clu.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="vertically-splited-multiple-data">Vertically splited multiple data<a class="anchor" aria-label="anchor" href="#vertically-splited-multiple-data"></a>
</h4>
<p>If you have multiple datasets, you should combine them at this stage.
If multiple datasets are given and they have the same variable name, you
can use <code>rbind</code> function to combine data together. If you
have different datasets with different variable names except for some
key variables, you can use <code>merge_data</code> function to combine
them together.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Read example data</span></span>
<span><span class="va">dt_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_A.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span>,</span>
<span>  colClasses <span class="op">=</span> <span class="st">"character"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dt_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_B.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span>,</span>
<span>  colClasses <span class="op">=</span> <span class="st">"character"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read DLU and CLU</span></span>
<span><span class="va">dlu_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_A_DLU.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dlu_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_B_DLU.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clu_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_A_CLU.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clu_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_B_CLU.csv"</span>, package <span class="op">=</span> <span class="st">"cctu"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge dataset with merge_data function</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/merge_data.html">merge_data</a></span><span class="op">(</span></span>
<span>  datalist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dt_a</span>, <span class="va">dt_b</span><span class="op">)</span>, dlulist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dlu_a</span>, <span class="va">dlu_b</span><span class="op">)</span>,</span>
<span>  clulist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">clu_a</span>, <span class="va">clu_b</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">data</span> <span class="co"># Extract combined data</span></span>
<span><span class="va">dlu</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">dlu</span> <span class="co"># Extract combined DLU data</span></span>
<span><span class="va">clu</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">clu</span> <span class="co"># Extract combined CLU data</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="apply-macro-dictionary">Apply macro dictionary<a class="anchor" aria-label="anchor" href="#apply-macro-dictionary"></a>
</h3>
<p>Next, we will apply the DLU and CLU files to the dataset. <strong>Do
not clean variable name</strong> in the dataset and DLU/CLU files before
applying <code>apply_macro_dict</code>. The function can handle variable
name cleaning by setting <code>clean_names = TRUE</code>, this is
default behaviour. The <code>apply_macro_dict</code> function will clean
the variable name in the DLU and CLU, then apply these macro meta data
to the target dataset. The cleaned DLU data will be sotred internally
and is further used by <code>cttab</code> to report missingness. You can
use <code>get_dlu</code> to extract the internal DLU data after applying
<code>apply_macro_dict</code> to the dataset for further useage or as a
reference. Although you can use <code>set_dlu</code> to change the
internal DLU data stored by <code>apply_macro_dict</code>, this is not
recommended unless you know what you are doing. This will have an impact
on the missing report.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create subjid</span></span>
<span><span class="va">dt</span><span class="op">$</span><span class="va">subjid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">USUBJID</span>, <span class="fl">8</span>, <span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply CLU and DLU files</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_macro_dict.html">apply_macro_dict</a></span><span class="op">(</span><span class="va">dt</span>, dlu <span class="op">=</span> <span class="va">dlu</span>, clu <span class="op">=</span> <span class="va">clu</span>, clean_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Give new variable a label</span></span>
<span><span class="fu"><a href="../reference/var_lab.html">var_lab</a></span><span class="op">(</span><span class="va">dt</span><span class="op">$</span><span class="va">subjid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Subject ID"</span></span></code></pre></div>
<p>After this, you should follow the <code>Analysis Template</code>
vignette and setup the population etc.</p>
<p>Next we will do some data analysis.</p>
</div>
<div class="section level3">
<h3 id="data-analysis">Data analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h3>
<p>After you have attached the population, next thing you may want to do
is extract a particular form from the data. For the table, assume we are
reporting age, sex and BMI from the patient registration form by
treatment arm. For demonstrating the filtering, we only report non-white
patients’ BMI.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Attach population</span></span>
<span><span class="fu"><a href="../reference/attach_pop.html">attach_pop</a></span><span class="op">(</span><span class="st">"1.1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract patient patient registration form and keep subjid variable</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_form.html">extract_form</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">"PatientReg"</span>, vars_keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subjid"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now report Age, Sex and BMI. For BMI, report not white only</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"BMIBL"</span><span class="op">)</span>, <span class="co"># Variable to report</span></span>
<span>  group <span class="op">=</span> <span class="st">"ARM"</span>, <span class="co"># Group variable</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>, <span class="co"># Data</span></span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BMIBL"</span> <span class="op">=</span> <span class="st">"RACEN != 1"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># Filter for variable BMI</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Write table</span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Age                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Sex                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="formula-interface">Formula interface<a class="anchor" aria-label="anchor" href="#formula-interface"></a>
</h3>
<p>One can use formula in the <code>cctab</code> just like
<code>lm</code>, but you will not be able to group variables (described
in the later section). The left hand side of the formula is the
variables to be summarised. Right hand side of the formula is the
grouping and/or row splitting variables. The by visit variable should be
separated by <code>|</code> with grouping variable, use <code>1</code>
if there is no grouping variables. No <code>group</code> or
<code>row_split</code> parameters to be used in the formula interface.
All the other parameters are the same.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># No grouping</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">BMIBL</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="co"># Group summarise by ARM</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span><span class="va">AGE</span> <span class="op">+</span> <span class="va">SEX</span> <span class="op">+</span> <span class="va">BMIBL</span> <span class="op">~</span> <span class="va">ARM</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="co"># Group summarise by ARM and split by visit cycle</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span><span class="va">AST</span> <span class="op">+</span> <span class="va">BILI</span> <span class="op">~</span> <span class="va">ARM</span> <span class="op">|</span> <span class="va">AVISIT</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="co"># Split by visit cycle</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span><span class="va">AST</span> <span class="op">+</span> <span class="va">BILI</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">AVISIT</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="missing-data-report">Missing data report<a class="anchor" aria-label="anchor" href="#missing-data-report"></a>
</h3>
<p>The <code>cttab</code> function will report the missing internally.
You can use the following to get the missing report.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This will save the missing report under Output folder</span></span>
<span><span class="co"># Or you can set the output folder and name</span></span>
<span><span class="fu"><a href="../reference/dump_missing_report.html">dump_missing_report</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pull out the missing report if you want</span></span>
<span><span class="va">miss_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dump_missing_report.html">get_missing_report</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reset missing report</span></span>
<span><span class="fu"><a href="../reference/dump_missing_report.html">reset_missing_report</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>After this, you can finish the remaining as in the
<code>Analysis Template</code> vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="more-to-cttab">More to cttab<a class="anchor" aria-label="anchor" href="#more-to-cttab"></a>
</h2>
<p>As you have seen previously, the <code>cttab</code> function can
easily populate simple tables.</p>
<div class="section level3">
<h3 id="simple-table">Simple table<a class="anchor" aria-label="anchor" href="#simple-table"></a>
</h3>
<p>Table only some variables, no treatment arm or variable
selection.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"BMIBL"</span><span class="op">)</span>, <span class="co"># Variable to report</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span></span>
<span><span class="op">)</span> <span class="co"># Data</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┐</span></span>
<span><span class="co">#&gt; |                   │      Total      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Age                                  |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       100       |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   75.1 (7.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│77.0 [56.0, 88.0]|</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Sex                                  |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Female           │  51/100 (51%)   |</span></span>
<span><span class="co">#&gt; |  Male             │  49/100 (49%)   |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Baseline BMI (kg/m^2)                |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       100       |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   24.5 (4.15)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│24.4 [13.7, 33.6]|</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="by-group-and-filter">By group and filter<a class="anchor" aria-label="anchor" href="#by-group-and-filter"></a>
</h3>
<p>This is what we have seen before</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"BMIBL"</span><span class="op">)</span>, <span class="co"># Variable to report</span></span>
<span>  group <span class="op">=</span> <span class="st">"ARM"</span>, <span class="co"># Group variable</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>, <span class="co"># Data</span></span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BMIBL"</span> <span class="op">=</span> <span class="st">"RACEN != 1"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="co"># Filter for variable BMI</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-14-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Age                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Sex                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="split-table-row-by-visit">Split table row by visit<a class="anchor" aria-label="anchor" href="#split-table-row-by-visit"></a>
</h3>
<p>You can define <code>row_split</code> parameter to the name of visit
or repeat variable.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/attach_pop.html">attach_pop</a></span><span class="op">(</span><span class="st">"1.1"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_form.html">extract_form</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">"Lab"</span>, vars_keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subjid"</span>, <span class="st">"ARM"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AST"</span>, <span class="st">"BILI"</span>, <span class="st">"ALT"</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"ARM"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  row_split <span class="op">=</span> <span class="st">"AVISIT"</span>, <span class="co"># Visit variable</span></span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ALT"</span> <span class="op">=</span> <span class="st">"PERF == 1"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Study Visit = Baseline                                                   |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       47        │       52        │       99        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   23.4 (7.09)   │   23.6 (7.05)   │   23.5 (7.04)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 54.0]│21.5 [13.0, 52.0]│23.0 [12.0, 54.0]|</span></span>
<span><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       46        │       51        │       97        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   10.0 (4.38)   │   11.4 (6.01)   │   10.8 (5.32)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 25.7]│10.3 [5.13, 39.3]│10.3 [5.13, 39.3]|</span></span>
<span><span class="co">#&gt; |  Missing          │     2 (4%)      │     1 (2%)      │     3 (3%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       45        │       40        │       85        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   18.1 (8.01)   │   22.1 (13.2)   │   20.0 (10.9)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│16.0 [7.00, 50.0]│17.0 [8.00, 64.0]│16.0 [7.00, 64.0]|</span></span>
<span><span class="co">#&gt; |  Missing          │                 │     2 (5%)      │     2 (2%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Study Visit = Week 4                                                     |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       43        │       44        │       87        |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       41        │       43        │       84        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   25.1 (18.4)   │   23.8 (6.39)   │   24.4 (13.6)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 135] │23.0 [12.0, 43.0]│23.0 [12.0, 135] |</span></span>
<span><span class="co">#&gt; |  Missing          │     2 (5%)      │     1 (2%)      │     3 (3%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       42        │       44        │       86        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   12.7 (18.2)   │   11.4 (6.51)   │   12.0 (13.5)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 125] │8.55 [5.13, 34.2]│8.55 [5.13, 125] |</span></span>
<span><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       39        │       38        │       77        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   18.9 (16.1)   │   21.6 (11.0)   │   20.2 (13.8)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│15.0 [7.00, 107] │20.0 [8.00, 61.0]│16.0 [7.00, 107] |</span></span>
<span><span class="co">#&gt; |  Missing          │                 │     3 (7%)      │     3 (4%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Study Visit = End of Treatment                                           |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       47        │       50        │       97        |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       45        │       48        │       93        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   27.4 (27.9)   │   23.1 (6.04)   │   25.2 (19.9)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│21.0 [14.0, 168] │23.0 [12.0, 39.0]│22.0 [12.0, 168] |</span></span>
<span><span class="co">#&gt; |  Missing          │     2 (4%)      │     2 (4%)      │     4 (4%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Bilirubin (umol/L)                                                       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       45        │       46        │       91        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   12.5 (17.7)   │   11.5 (6.39)   │   12.0 (13.2)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│8.55 [5.13, 125] │10.3 [3.42, 30.8]│8.55 [3.42, 125] |</span></span>
<span><span class="co">#&gt; |  Missing          │     2 (4%)      │     4 (8%)      │     6 (6%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       45        │       43        │       88        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   19.6 (21.8)   │   19.7 (8.41)   │   19.6 (16.6)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│14.0 [5.00, 124] │17.0 [9.00, 43.0]│16.0 [5.00, 124] |</span></span>
<span><span class="co">#&gt; |  Missing          │                 │     1 (2%)      │     1 (1%)      |</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="group-variable">Group variable<a class="anchor" aria-label="anchor" href="#group-variable"></a>
</h3>
<p>In this example, we will report demographic variable, lab results and
lab abnormality. Variables will be grouped, no group name will be given
to demographic variables, “Blood” to lab results and “Pts with Abnormal”
to lab abnormality. Here, we count the number of patients with abnormal
lab results. The <code>cttab</code> will report the count and percentage
of <code>TRUE</code>. This is useful if you want to report patient
numbers for different condition that belong to one category. Below is
how to do it:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data as before</span></span>
<span><span class="fu"><a href="../reference/attach_pop.html">attach_pop</a></span><span class="op">(</span><span class="st">"1.1"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_form.html">extract_form</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">"PatientReg"</span>, vars_keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subjid"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">base_lab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_form.html">extract_form</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">"Lab"</span>,</span>
<span>  visit <span class="op">=</span> <span class="st">"SCREENING"</span>,</span>
<span>  vars_keep <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subjid"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define abnormal</span></span>
<span><span class="va">base_lab</span><span class="op">$</span><span class="va">ABNORMALT</span> <span class="op">&lt;-</span> <span class="va">base_lab</span><span class="op">$</span><span class="va">ALT</span> <span class="op">&gt;</span> <span class="fl">22.5</span></span>
<span><span class="fu"><a href="../reference/var_lab.html">var_lab</a></span><span class="op">(</span><span class="va">base_lab</span><span class="op">$</span><span class="va">ABNORMALT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"ALT abnormal"</span></span>
<span><span class="va">base_lab</span><span class="op">$</span><span class="va">ABNORMAST</span> <span class="op">&lt;-</span> <span class="va">base_lab</span><span class="op">$</span><span class="va">AST</span> <span class="op">&gt;</span> <span class="fl">25.5</span></span>
<span><span class="fu"><a href="../reference/var_lab.html">var_lab</a></span><span class="op">(</span><span class="va">base_lab</span><span class="op">$</span><span class="va">ABNORMAST</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"AST abnormal"</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">base_lab</span>, by <span class="op">=</span> <span class="st">"subjid"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Table</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"BMIBL"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Group lab variable</span></span>
<span>    <span class="st">"Blood"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ALT"</span>, <span class="st">"AST"</span><span class="op">)</span>,</span>
<span>    <span class="co"># Group abnormal variable</span></span>
<span>    <span class="st">"Pts with Abnormal"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABNORMAST"</span>, <span class="st">"ABNORMALT"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"ARM"</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  <span class="co"># Add some filtering</span></span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"BMIBL"</span> <span class="op">=</span> <span class="st">"RACEN != 1"</span>,</span>
<span>    <span class="st">"ALT"</span> <span class="op">=</span> <span class="st">"PERF == 1"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┬─────────────────┬─────────────────┐</span></span>
<span><span class="co">#&gt; |                   │     Placebo     │    Research     │      Total      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Age                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       48        │       52        │       100       |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   75.5 (7.86)   │   74.8 (8.04)   │   75.1 (7.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│78.0 [57.0, 88.0]│77.0 [56.0, 88.0]│77.0 [56.0, 88.0]|</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Sex                                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Female           │   26/48 (54%)   │   25/52 (48%)   │  51/100 (51%)   |</span></span>
<span><span class="co">#&gt; |  Male             │   22/48 (46%)   │   27/52 (52%)   │  49/100 (49%)   |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                    |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │        5        │        6        │       11        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   27.8 (3.98)   │   24.6 (3.54)   │   26.0 (3.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│27.9 [23.4, 32.8]│23.5 [21.3, 31.4]│24.3 [21.3, 32.8]|</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Blood                                                                    |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Alanine Aminotransferase (U/L)                                           |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       45        │       40        │       85        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   18.1 (8.01)   │   22.1 (13.2)   │   20.0 (10.9)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│16.0 [7.00, 50.0]│17.0 [8.00, 64.0]│16.0 [7.00, 64.0]|</span></span>
<span><span class="co">#&gt; |  Missing          │                 │     2 (5%)      │     2 (2%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Aspartate Aminotransferase (U/L)                                         |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       47        │       52        │       99        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │   23.4 (7.09)   │   23.6 (7.05)   │   23.5 (7.04)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│23.0 [12.0, 54.0]│21.5 [13.0, 52.0]│23.0 [12.0, 54.0]|</span></span>
<span><span class="co">#&gt; |  Missing          │     1 (2%)      │                 │     1 (1%)      |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴─────────────────┴─────────────────┤</span></span>
<span><span class="co">#&gt; |Pts with Abnormal                                                        |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬─────────────────┬─────────────────┤</span></span>
<span><span class="co">#&gt; |AST abnormal       │   13/48 (27%)   │   17/52 (33%)   │  30/100 (30%)   |</span></span>
<span><span class="co">#&gt; |ALT abnormal       │   9/48 (19%)    │   11/52 (21%)   │  20/100 (20%)   |</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┴─────────────────┴─────────────────┘</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rounding">Rounding<a class="anchor" aria-label="anchor" href="#rounding"></a>
</h3>
<p>The default behaviour of this function is to keep one digits for the
percentage and 3 significant value for the numerical values. The default
rounding function is <code>signif_pad</code>, you can also use
<code>round</code> or <code>round_pad</code> to keep digits in the
summary. The <code>format_percent</code> function is used to format the
percentage values. There is <code>format_pval</code> might be useful to
you.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cttab.html">cttab</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span>, <span class="st">"BMIBL"</span><span class="op">)</span>, <span class="co"># Variable to report</span></span>
<span>  group <span class="op">=</span> <span class="st">"ARM"</span>, <span class="co"># Group variable</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>, <span class="co"># Data</span></span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Keep 2 digits for numerical</span></span>
<span>  digits_pct <span class="op">=</span> <span class="fl">1</span>, <span class="co"># Keep 1 digits for percentage</span></span>
<span>  rounding_fn <span class="op">=</span> <span class="va">round</span></span>
<span><span class="op">)</span> <span class="co"># Use function round for rounding</span></span></code></pre></div>
<p><img src="using-cttab_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">X</span></span>
<span><span class="co">#&gt; ┌───────────────────┬─────────────────┬──────────────────┬──────────────────┐</span></span>
<span><span class="co">#&gt; |                   │     Placebo     │     Research     │      Total       |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span><span class="co">#&gt; |Observation        │       48        │        52        │       100        |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span><span class="co">#&gt; |Age                                                                        |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       48        │        52        │       100        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │  75.52 (7.86)   │   74.75 (8.04)   │   75.12 (7.93)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│   78 [57, 88]   │   77 [56, 88]    │   77 [56, 88]    |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span><span class="co">#&gt; |Sex                                                                        |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span><span class="co">#&gt; |  Female           │  26/48 (54.2%)  │  25/52 (48.1%)   │  51/100 (51.0%)  |</span></span>
<span><span class="co">#&gt; |  Male             │  22/48 (45.8%)  │  27/52 (51.9%)   │  49/100 (49.0%)  |</span></span>
<span><span class="co">#&gt; ├───────────────────┴─────────────────┴──────────────────┴──────────────────┤</span></span>
<span><span class="co">#&gt; |Baseline BMI (kg/m^2)                                                      |</span></span>
<span><span class="co">#&gt; ├───────────────────┬─────────────────┬──────────────────┬──────────────────┤</span></span>
<span><span class="co">#&gt; |  Valid Obs.       │       48        │        52        │       100        |</span></span>
<span><span class="co">#&gt; |  Mean (SD)        │  23.55 (4.05)   │   25.29 (4.1)    │   24.45 (4.15)   |</span></span>
<span><span class="co">#&gt; |  Median [Min, Max]│23.1 [15.1, 33.3]│25.25 [13.7, 33.6]│24.35 [13.7, 33.6]|</span></span>
<span><span class="co">#&gt; └───────────────────┴─────────────────┴──────────────────┴──────────────────┘</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simon Bond, Alimu Dayimu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
